import {
  AbnormalJobScraper,
  AnomaloJobScraper,
  CardinalopsJobScraper,
  ChecklyJobHandler,
  CredoJobHandler,
  DashJobHandler,
  DoxelJobHandler,
  EndorLabsJobScraper,
  EnterpretJobHandler,
  FarSightJobHandler,
  FluidStackJobHandler,
  FormantJobScraper,
  HightouchJobScraper,
  IoJobHandler,
  LaurelJobHandler,
  LegionJobScraper,
  LeptonJobScraper,
  LoopJobHandler,
  LumosJobScraper,
  MaraTalentHandler,
  MaterializeJobScraper,
  NumericJobHandler,
  OmneaJobHandler,
  OperantaiJobScraper,
  PivotalJobScraper,
  PortJobScraper,
  RecruitmentJobHandler,
  RelyanceJobHandler,
  RoboFlowJobScraper,
  SafeJobHandler,
  SeeChangeJobHandler,
  SysdigJobHandler,
  TeleportJobHandler,
  VoizeJobHandler,
  VorlonJobScraper,
  WebaiJobHandler,
  AntithesisJobHandler,
  GetbalanceScraper,
  BasetenScraper,
  BlinkOpsJobHandler,
  BlockaidScraper,
  BynderJobHandler,
  CastAIJobHandler,
  ChainguardJobHandler,
  CheckmarxScraper,
  CockroachLabsJobHandler,
  CognitionJobHandler,
  MerlinJobHandler,
  CynomiJobHandler,
  DeepsetScraper,
  FactoryScraper,
  ForterJobHandler,
  GroundcoverJobHandler,
  HaiiloJobHandler,
  HebbiaJobHandler,
  HoneycombJobHandler,
  IncidentJobHandler,
  IslandJobHandler,
  KurrentJobHandler,
  LaunchDarklyJobHandler,
  MablJobHandler,
  MazeJobHandler,
  MergeJobHandler,
  MetalBearJobHandler,
  MindtickleJobHandler,
  NavanJobHandler,
  OasisSecurityJobHandler,
  OctopusJobHandler,
  OpalJobHandler,
  OrcaAIScraper,
  PlaxidityxJobHandler,
  RedwoodJobHandler,
  ScytaleJobHandler,
  SingleStoreJobHandler,
  SnorkelAIJobHandler,
  TraceBitJobHandler,
  UserTestingJobHandler,
  VegaJobHandler,
  VezaJobHandler,
  WatershedJobHandler,
  WorkOSJobHandler,
  YoobicScraper,
  CoderabbitJobHandler,
  LinxJobHandler,
  VClusterJobHandler,
  OscilarJobHandler,
  PrimeSecurityJobHandler,
  SpectrocloudScraper,
  VelotixJobHandler,
  VercelJobHandler,
  RoxJobHandler,
  ConductJobHandler,
  SynthflowJobHandler,
  EndeavorJobHandler,
  ChronosphereJobHandler,
  ZenityJobHandler,
  CoderJobHandler,
  ZiplineRetailScraper,
  StackOneJobHandler,
  SevenAIJobHandler,
  OpaqueJobHandler,
  ClickHouseJobHandler,
  ContextualJobHandler,
  CorridorJobHandler,
  DecagonJobHandler,
  DreamJobHandler,
  ElevenlabsJobHandler,
  OmniJobHandler,
  FoundationalJobHandler,
  Horizon3JobHandler,
  InstruqtJobHandler,
  PhoebeJobHandler,
  StainlessJobHandler,
  TurnkeyJobHandler,
  WriterJobHandler,
  AvocaJobHandler,
  CertikJobHandler,
  PushSecurityJobHandler,
  SpruceJobHandler,
  TwingateJobHandler,
  LayerzeroJobHandler,
  LightrunJobHandler,
  LinearJobHandler,
  MedallionJobHandler,
  NomaJobHandler,
  PactumJobHandler,
  PenteraJobHandler,
  PlayzeroJobHandler,
  RekaJobHandler,
  ReplicateJobHandler,
  ResolveJobHandler,
  SeonJobHandler,
  SgnlJobHandler,
  SierraJobHandler,
  SolaJobHandler,
  StacklokJobHandler,
  AponoJobHandler,
  ArmadaJobHandler,
  BrowserbaseJobHandler,
  CasapJobHandler,
  CyfirmaJobHandler,
  DataikuJobHandler,
  EthycaJobHandler,
  ExaforceJobHandler,
  FiddlerJobHandler,
  FlockSafetyJobHandler,
  FyxerJobHandler,
  DbtLabsJobHandler,
  GraviteeJobHandler,
  HyprJobHandler,
  KognitosJobHandler,
  LakeraJobHandler,
  LangChainJobHandler,
  LogicGateJobHandler,
  MinJobHandler,
  ObsidianSecurityJobHandler,
  PigmentJobHandler,
  ProphetSecurityJobHandler,
  ScylladbJobHandler,
  SilverFortJobHandler,
  TavilyJobHandler,
  TokenSecurityJobHandler,
  TruliooJobHandler,
  UnframeJobHandler,
  UpwindJobHandler,
  WorkatoJobHandler,
  ZafranJobHandler,
  ZipsecJobHandler,
  ZeroNetworksJobHandler,
  AleoJobHandler,
  AsimilyJobHandler,
  BolsterJobHandler,
  CogentJobHandler,
  CriblJobHandler,
  DaylightJobHandler,
  DeepgramJobHandler,
  DuneJobHandler,
  DustJobHandler,
  EderaJobHandler,
  FernJobHandler,
  FieldGuideJobHandler,
  FiniteStateJobHandler,
  GalileoJobHandler,
  HalcyonJobHandler,
  LegitJobHandler,
  OpsinJobHandler,
  OrkesJobHandler,
  ProfoundJobHandler,
  RunrevealJobHandler,
  SuperAIJobHandler,
  SymbioticJobHandler,
  TalosJobHandler,
  TatumJobHandler,
  TrustmiJobHandler,
  ZestScraper,
  CerbyJobHandler,
  PlanhatScraper,
  ApolloGraphQlJobHandler,
  FlutterFlowJobHandler,
  SynadiaJobHandler,
  SecureframeJobHandler,
  DatavisorJobHandler,
  InfisicalJobHandler,
  ChalkJobHandler,
  ReflectionaiJobHandler,
  ClearVectorJobHandler,
  FableJobHandler,
  XMCyberJobHandler,
  ModalJobHandler,
  PayabliJobHandler,
  MindsdbJobHandler,
  LovableJobHandler,
  SecuritiJobHandler,
  ExaJobHandler,
  UnstructuredJobHandler,
  AkeylessJobHandler,
  KongJobHandler,
  OrcaSecurityJobHandler,
  OpteryJobHandler,
  WorldJobHandler,
  RhombusJobHandler,
  AirtableJobHandler,
  CynerioJobHandler,
  KindoJobHandler,
  WordsmithJobHandler,
  MoonvalleyJobHandler,
  DualEntryJobHandler,
  TraversalJobHandler,
  SolaAIJobHandler,
  AmebaJobHandler,
  CluelyJobHandler,
  SalientJobHandler,
  AnteriorHandler,
  CredalJobHandler,
  JuliusJobHandler,
  CampfireJobHandler,
  PayflowsJobHandler,
  PeecJobHandler,
  RetellJobHandler,
  QuantaScraper,
  PulseJobHandler,
  OsiumScraper,
  NumeralJobHandler,
  WordwareJobHandler,
  AlbertinventJobHandler,
  LlamaindexJobHandler,
  HarperJobHandler,
  NormAIJobHandler,
  HadriusJobHandler,
  CrewaiJobHandler,
  PylonJobHandler,
  BasisJobHandler,
  SapienJobHandler,
  TabsJobHandler,
  DideroJobHandler,
  StarcloudJobHandler,
  AssorthealthJobHandler,
  ZockJobHandler,
  GreenliteJobHandler,
  FurtherJobHandler,
  EloquentJobHandler,
  BraintrustJobHandler,
  DropzoneJobHandler,
  BluefishJobHandler,
  RunzeroJobHandler,
  EchosoftwareJobHandler,
} from "./src";
import { buildMessage } from "./src/global";

async function test_message() {
  const active_channel_blocks = [
    {
      type: "section",
      text: {
        type: "mrkdwn",
        text: "This is a test message from the job scraper to active channel !",
      },
    },
  ];

  const prospect_channel_blocks = [
    {
      type: "section",
      text: {
        type: "mrkdwn",
        text: "This is a test message from the job scraper to prospect channel !",
      },
    },
  ];

  // Send to active channel
  console.log("Sending test message to active channel...");
  await buildMessage(1, active_channel_blocks);

  // Send to prospect channel
  console.log("Sending test message to prospect channel...");
  await buildMessage(2, prospect_channel_blocks);
}

async function runScraperSafely(
  scraperName: string,
  scraperFunction: () => Promise<{
    blocks: any[];
    channel: number;
  }>
): Promise<{
  blocks: any[];
  channel: number;
  status: boolean;
}> {
  console.time(scraperName);
  try {
    const result = await scraperFunction();
    console.log(`✅ ${scraperName} completed successfully`);
    return {
      blocks: result.blocks,
      channel: result.channel,
      status: true,
    };
  } catch (error) {
    console.error(`❌ ${scraperName} failed with error:`);
    console.error(
      `Error message: ${error instanceof Error ? error.message : String(error)}`
    );
    if (error instanceof Error && error.stack) {
      console.error(`Stack trace: ${error.stack}`);
    }
    console.log(`⏭️  Continuing to next scraper...`);
    return {
      blocks: [],
      channel: 0,
      status: false,
    };
  } finally {
    console.timeEnd(scraperName);
  }
}

async function main() {
  console.log("🚀 Starting job scrapers...");
  console.log(`Started at: ${new Date().toISOString()}`);
  console.time("Total Scraping Time");

  let successCount = 0;
  let errorCount = 0;

  const scrapers = [
    { name: "Abnormal", run: () => AbnormalJobScraper.run() },
    { name: "Anomalo", run: () => AnomaloJobScraper.run() },
    { name: "Cardinalops", run: () => CardinalopsJobScraper.run() },
    { name: "Checkly", run: () => ChecklyJobHandler.run() },
    { name: "Credo", run: () => CredoJobHandler.run() },
    { name: "Dash", run: () => DashJobHandler.run() },
    { name: "Doxel", run: () => DoxelJobHandler.run() },
    { name: "EndorLabs", run: () => EndorLabsJobScraper.run() },
    { name: "Enterpret", run: () => EnterpretJobHandler.run() },
    { name: "FarSight", run: () => FarSightJobHandler.run() },
    { name: "FluidStack", run: () => FluidStackJobHandler.run() },
    { name: "Formant", run: () => FormantJobScraper.run() },
    { name: "Hightouch", run: () => HightouchJobScraper.run() },
    { name: "Io", run: () => IoJobHandler.run() },
    { name: "Laurel", run: () => LaurelJobHandler.run() },
    { name: "Legion", run: () => LegionJobScraper.run() },
    // { name: "Lepton", run: () => LeptonJobScraper.run() },
    { name: "Loop", run: () => LoopJobHandler.run() },
    { name: "Lumos", run: () => LumosJobScraper.run() },
    // { name: "MaraTalent", run: () => MaraTalentHandler.run() },
    { name: "Materialize", run: () => MaterializeJobScraper.run() },
    { name: "Numeric", run: () => NumericJobHandler.run() },
    { name: "Omnea", run: () => OmneaJobHandler.run() },
    { name: "Operantai", run: () => OperantaiJobScraper.run() },
    // { name: "Pivotal", run: () => PivotalJobScraper.run() },
    { name: "Port", run: () => PortJobScraper.run() },
    { name: "Recruitment", run: () => RecruitmentJobHandler.run() },
    { name: "Relyance", run: () => RelyanceJobHandler.run() },
    { name: "RoboFlow", run: () => RoboFlowJobScraper.run() },
    { name: "Safe", run: () => SafeJobHandler.run() },
    { name: "SeeChange", run: () => SeeChangeJobHandler.run() },
    { name: "Sysdig", run: () => SysdigJobHandler.run() },
    { name: "Teleport", run: () => TeleportJobHandler.run() },
    { name: "Voize", run: () => VoizeJobHandler.run() },
    { name: "Vorlon", run: () => VorlonJobScraper.run() },
    { name: "Webai", run: () => WebaiJobHandler.run() },
    { name: "Antithesis", run: () => AntithesisJobHandler.run() },
    { name: "GetBalance", run: () => GetbalanceScraper.run() },
    { name: "Baseten", run: () => BasetenScraper.run() },
    { name: "BlinkOps", run: () => BlinkOpsJobHandler.run() },
    { name: "Blockaid", run: () => BlockaidScraper.run() },
    // { name: "Bynder", run: () => BynderJobHandler.run() },
    { name: "CastAI", run: () => CastAIJobHandler.run() },
    { name: "Chainguard", run: () => ChainguardJobHandler.run() },
    { name: "Checkmarx", run: () => CheckmarxScraper.run() },
    { name: "CockroachLabs", run: () => CockroachLabsJobHandler.run() },
    { name: "Cognition", run: () => CognitionJobHandler.run() },
    { name: "Merlin", run: () => MerlinJobHandler.run() },
    { name: "Cynomi", run: () => CynomiJobHandler.run() },
    { name: "Deepset", run: () => DeepsetScraper.run() },
    { name: "Factory", run: () => FactoryScraper.run() },
    { name: "Forter", run: () => ForterJobHandler.run() },
    { name: "Groundcover", run: () => GroundcoverJobHandler.run() },
    { name: "Haiilo", run: () => HaiiloJobHandler.run() },
    { name: "Hebbia", run: () => HebbiaJobHandler.run() },
    { name: "Honeycomb", run: () => HoneycombJobHandler.run() },
    { name: "Incident", run: () => IncidentJobHandler.run() },
    { name: "Island", run: () => IslandJobHandler.run() },
    { name: "Kurrent", run: () => KurrentJobHandler.run() },
    { name: "LaunchDarkly", run: () => LaunchDarklyJobHandler.run() },
    { name: "Mabl", run: () => MablJobHandler.run() },
    { name: "Maze", run: () => MazeJobHandler.run() },
    { name: "Merge", run: () => MergeJobHandler.run() },
    { name: "MetalBear", run: () => MetalBearJobHandler.run() },
    { name: "MindTickle", run: () => MindtickleJobHandler.run() },
    { name: "Navan", run: () => NavanJobHandler.run() },
    { name: "OasisSecurity", run: () => OasisSecurityJobHandler.run() },
    { name: "Octopus", run: () => OctopusJobHandler.run() },
    { name: "Opal", run: () => OpalJobHandler.run() },
    { name: "OrcaAI", run: () => OrcaAIScraper.run() },
    { name: "PlaxidityX", run: () => PlaxidityxJobHandler.run() },
    { name: "Redwood", run: () => RedwoodJobHandler.run() },
    { name: "Scytale", run: () => ScytaleJobHandler.run() },
    { name: "SingleStore", run: () => SingleStoreJobHandler.run() },
    { name: "SnorkelAI", run: () => SnorkelAIJobHandler.run() },
    { name: "TraceBit", run: () => TraceBitJobHandler.run() },
    { name: "UserTesting", run: () => UserTestingJobHandler.run() },
    { name: "Vega", run: () => VegaJobHandler.run() },
    { name: "Veza", run: () => VezaJobHandler.run() },
    { name: "Watershed", run: () => WatershedJobHandler.run() },
    { name: "WorkOS", run: () => WorkOSJobHandler.run() },
    { name: "Yoobic", run: () => YoobicScraper.run() },
    { name: "CodeRabbit", run: () => CoderabbitJobHandler.run() },
    { name: "Linx", run: () => LinxJobHandler.run() },
    { name: "VCluster", run: () => VClusterJobHandler.run() },
    { name: "Oscilar", run: () => OscilarJobHandler.run() },
    { name: "PrimeSecurity", run: () => PrimeSecurityJobHandler.run() },
    { name: "SpectroCloud", run: () => SpectrocloudScraper.run() },
    { name: "Velotix", run: () => VelotixJobHandler.run() },
    { name: "Vercel", run: () => VercelJobHandler.run() },
    { name: "Rox", run: () => RoxJobHandler.run() },
    { name: "Conduct", run: () => ConductJobHandler.run() },
    { name: "Synthflow", run: () => SynthflowJobHandler.run() },
    { name: "Endeavor", run: () => EndeavorJobHandler.run() },
    { name: "Chronosphere", run: () => ChronosphereJobHandler.run() },
    { name: "Zenity", run: () => ZenityJobHandler.run() },
    { name: "Coder", run: () => CoderJobHandler.run() },
    { name: "ZiplineRetail", run: () => ZiplineRetailScraper.run() },
    { name: "StackOne", run: () => StackOneJobHandler.run() },
    { name: "SevenAI", run: () => SevenAIJobHandler.run() },
    { name: "Opaque", run: () => OpaqueJobHandler.run() },
    { name: "ClickHouse", run: () => ClickHouseJobHandler.run() },
    { name: "Contextual", run: () => ContextualJobHandler.run() },
    { name: "Corridor", run: () => CorridorJobHandler.run() },
    { name: "Decagon", run: () => DecagonJobHandler.run() },
    { name: "Dream", run: () => DreamJobHandler.run() },
    { name: "Elevenlabs", run: () => ElevenlabsJobHandler.run() },
    { name: "Omni", run: () => OmniJobHandler.run() },
    { name: "Foundational", run: () => FoundationalJobHandler.run() },
    { name: "Horizon3", run: () => Horizon3JobHandler.run() },
    { name: "Instruqt", run: () => InstruqtJobHandler.run() },
    { name: "Phoebe", run: () => PhoebeJobHandler.run() },
    { name: "Stainless", run: () => StainlessJobHandler.run() },
    { name: "Turnkey", run: () => TurnkeyJobHandler.run() },
    { name: "Writer", run: () => WriterJobHandler.run() },
    { name: "Avoca", run: () => AvocaJobHandler.run() },
    { name: "Certik", run: () => CertikJobHandler.run() },
    { name: "PushSecurity", run: () => PushSecurityJobHandler.run() },
    { name: "Spruce", run: () => SpruceJobHandler.run() },
    { name: "Twingate", run: () => TwingateJobHandler.run() },
    { name: "Layerzero", run: () => LayerzeroJobHandler.run() },
    { name: "Lightrun", run: () => LightrunJobHandler.run() },
    { name: "Linear", run: () => LinearJobHandler.run() },
    { name: "Medallion", run: () => MedallionJobHandler.run() },
    { name: "Noma", run: () => NomaJobHandler.run() },
    { name: "Pactum", run: () => PactumJobHandler.run() },
    { name: "Pentera", run: () => PenteraJobHandler.run() },
    { name: "Playzero", run: () => PlayzeroJobHandler.run() },
    { name: "Reka", run: () => RekaJobHandler.run() },
    { name: "Replicate", run: () => ReplicateJobHandler.run() },
    { name: "Resolve", run: () => ResolveJobHandler.run() },
    { name: "Seon", run: () => SeonJobHandler.run() },
    { name: "Sgnl", run: () => SgnlJobHandler.run() },
    { name: "Sierra", run: () => SierraJobHandler.run() },
    { name: "Sola", run: () => SolaJobHandler.run() },
    { name: "Stacklok", run: () => StacklokJobHandler.run() },
    { name: "Apono", run: () => AponoJobHandler.run() },
    { name: "Armada", run: () => ArmadaJobHandler.run() },
    { name: "Browserbase", run: () => BrowserbaseJobHandler.run() },
    { name: "Casap", run: () => CasapJobHandler.run() },
    { name: "Cyfirma", run: () => CyfirmaJobHandler.run() },
    { name: "Dataiku", run: () => DataikuJobHandler.run() },
    { name: "Ethyca", run: () => EthycaJobHandler.run() },
    { name: "Exaforce", run: () => ExaforceJobHandler.run() },
    { name: "Fiddler", run: () => FiddlerJobHandler.run() },
    { name: "FlockSafety", run: () => FlockSafetyJobHandler.run() },
    { name: "Fyxer", run: () => FyxerJobHandler.run() },
    { name: "Dbtlabs", run: () => DbtLabsJobHandler.run() },
    { name: "Gravitee", run: () => GraviteeJobHandler.run() },
    { name: "Hypr", run: () => HyprJobHandler.run() },
    { name: "Kognitos", run: () => KognitosJobHandler.run() },
    { name: "Lakera", run: () => LakeraJobHandler.run() },
    { name: "LangChain", run: () => LangChainJobHandler.run() },
    { name: "LogicGate", run: () => LogicGateJobHandler.run() },
    { name: "Min", run: () => MinJobHandler.run() },
    { name: "ObsidianSecurity", run: () => ObsidianSecurityJobHandler.run() },
    { name: "Pigment", run: () => PigmentJobHandler.run() },
    { name: "ProphetSecurity", run: () => ProphetSecurityJobHandler.run() },
    { name: "Scylladb", run: () => ScylladbJobHandler.run() },
    { name: "SilverFort", run: () => SilverFortJobHandler.run() },
    { name: "Tavily", run: () => TavilyJobHandler.run() },
    { name: "TokenSecurity", run: () => TokenSecurityJobHandler.run() },
    { name: "Trulioo", run: () => TruliooJobHandler.run() },
    { name: "Unframe", run: () => UnframeJobHandler.run() },
    { name: "Upwind", run: () => UpwindJobHandler.run() },
    { name: "Workato", run: () => WorkatoJobHandler.run() },
    { name: "Zafran", run: () => ZafranJobHandler.run() },
    { name: "Zipsec", run: () => ZipsecJobHandler.run() },
    { name: "ZeroNetworks", run: () => ZeroNetworksJobHandler.run() },
    { name: "Aleo", run: () => AleoJobHandler.run() },
    { name: "Asimily", run: () => AsimilyJobHandler.run() },
    { name: "Bolster", run: () => BolsterJobHandler.run() },
    { name: "Cogent", run: () => CogentJobHandler.run() },
    { name: "Cribl", run: () => CriblJobHandler.run() },
    { name: "Daylight", run: () => DaylightJobHandler.run() },
    { name: "Deepgram", run: () => DeepgramJobHandler.run() },
    { name: "Dune", run: () => DuneJobHandler.run() },
    { name: "Dust", run: () => DustJobHandler.run() },
    { name: "Edera", run: () => EderaJobHandler.run() },
    { name: "Fern", run: () => FernJobHandler.run() },
    { name: "FieldGuide", run: () => FieldGuideJobHandler.run() },
    { name: "FiniteState", run: () => FiniteStateJobHandler.run() },
    { name: "Galileo", run: () => GalileoJobHandler.run() },
    { name: "Halcyon", run: () => HalcyonJobHandler.run() },
    { name: "Legit", run: () => LegitJobHandler.run() },
    { name: "Opsin", run: () => OpsinJobHandler.run() },
    { name: "Orkes", run: () => OrkesJobHandler.run() },
    { name: "Profound", run: () => ProfoundJobHandler.run() },
    { name: "RunReveal", run: () => RunrevealJobHandler.run() },
    { name: "SuperAI", run: () => SuperAIJobHandler.run() },
    { name: "Symbiotic", run: () => SymbioticJobHandler.run() },
    { name: "Talos", run: () => TalosJobHandler.run() },
    { name: "Tatum", run: () => TatumJobHandler.run() },
    { name: "Trustmi", run: () => TrustmiJobHandler.run() },
    { name: "Zest", run: () => ZestScraper.run() },
    { name: "Cerby", run: () => CerbyJobHandler.run() },
    { name: "Planhat", run: () => PlanhatScraper.run() },
    { name: "ApolloGraphQL", run: () => ApolloGraphQlJobHandler.run() },
    { name: "FlutterFlow", run: () => FlutterFlowJobHandler.run() },
    { name: "Synadia", run: () => SynadiaJobHandler.run() },
    { name: "Secureframe", run: () => SecureframeJobHandler.run() },
    { name: "Datavisor", run: () => DatavisorJobHandler.run() },
    { name: "Infisical", run: () => InfisicalJobHandler.run() },
    { name: "Chalk", run: () => ChalkJobHandler.run() },
    { name: "ReflectionAI", run: () => ReflectionaiJobHandler.run() },
    { name: "ClearVector", run: () => ClearVectorJobHandler.run() },
    { name: "Fable", run: () => FableJobHandler.run() },
    { name: "XMCyber", run: () => XMCyberJobHandler.run() },
    { name: "Modal", run: () => ModalJobHandler.run() },
    { name: "Payabli", run: () => PayabliJobHandler.run() },
    { name: "MindsDB", run: () => MindsdbJobHandler.run() },
    { name: "Lovable", run: () => LovableJobHandler.run() },
    { name: "Securiti", run: () => SecuritiJobHandler.run() },
    { name: "Exa", run: () => ExaJobHandler.run() },
    { name: "Unstructured", run: () => UnstructuredJobHandler.run() },
    { name: "Akeyless", run: () => AkeylessJobHandler.run() },
    { name: "Kong", run: () => KongJobHandler.run() },
    { name: "OrcaSecurity", run: () => OrcaSecurityJobHandler.run() },
    { name: "Optery", run: () => OpteryJobHandler.run() },
    { name: "World", run: () => WorldJobHandler.run() },
    { name: "Rhombus", run: () => RhombusJobHandler.run() },
    { name: "Airtable", run: () => AirtableJobHandler.run() },
    { name: "Cynerio", run: () => CynerioJobHandler.run() },
    { name: "Kindo", run: () => KindoJobHandler.run() },
    { name: "Wordsmith", run: () => WordsmithJobHandler.run() },
    { name: "Moonvalley", run: () => MoonvalleyJobHandler.run() },
    { name: "Dualentry", run: () => DualEntryJobHandler.run() },
    { name: "Traversal", run: () => TraversalJobHandler.run() },
    { name: "SolaAI", run: () => SolaAIJobHandler.run() },
    { name: "Ameba", run: () => AmebaJobHandler.run() },
    { name: "Cluely", run: () => CluelyJobHandler.run() },
    { name: "Salient", run: () => SalientJobHandler.run() },
    { name: "Anterior", run: () => AnteriorHandler.run() },
    { name: "Credal", run: () => CredalJobHandler.run() },
    { name: "Julius", run: () => JuliusJobHandler.run() },
    { name: "Campfire", run: () => CampfireJobHandler.run() },
    { name: "Payflows", run: () => PayflowsJobHandler.run() },
    { name: "Peec", run: () => PeecJobHandler.run() },
    { name: "Retell", run: () => RetellJobHandler.run() },
    { name: "Quanta", run: () => QuantaScraper.run() },
    { name: "Pulse", run: () => PulseJobHandler.run() },
    { name: "Osium", run: () => OsiumScraper.run() },
    { name: "Numeral", run: () => NumeralJobHandler.run() },
    { name: "Wordware", run: () => WordwareJobHandler.run() },
    { name: "Albertinvent", run: () => AlbertinventJobHandler.run() },
    { name: "LlamaIndex", run: () => LlamaindexJobHandler.run() },
    { name: "Harper", run: () => HarperJobHandler.run() },
    { name: "Normai", run: () => NormAIJobHandler.run() },
    { name: "Hadrius", run: () => HadriusJobHandler.run() },
    { name: "CrewAI", run: () => CrewaiJobHandler.run() },
    { name: "Pylon", run: () => PylonJobHandler.run() },
    { name: "Basis", run: () => BasisJobHandler.run() },
    { name: "Sapien", run: () => SapienJobHandler.run() },
    { name: "Tabs", run: () => TabsJobHandler.run() },
    { name: "Didero", run: () => DideroJobHandler.run() },
    { name: "Starcloud", run: () => StarcloudJobHandler.run() },
    { name: "AssortHealth", run: () => AssorthealthJobHandler.run() },
    { name: "Zock", run: () => ZockJobHandler.run() },
    { name: "Greenlite", run: () => GreenliteJobHandler.run() },
    { name: "Further", run: () => FurtherJobHandler.run() },
    { name: "Eloquent", run: () => EloquentJobHandler.run() },
    { name: "Braintrust", run: () => BraintrustJobHandler.run() },
    { name: "Dropzone", run: () => DropzoneJobHandler.run() },
    { name: "Bluefish", run: () => BluefishJobHandler.run() },
    { name: "RunZero", run: () => RunzeroJobHandler.run() },
    { name: "EchoSoftware", run: () => EchosoftwareJobHandler.run() },
  ];

  console.log(`📊 Total scrapers to run: ${scrapers.length}`);
  console.log("─".repeat(50));
  const messageBlocks1: any[] = [];
  let messageChannel1 = 0;
  const messageBlocks2: any[] = [];
  let messageChannel2 = 0;
  for (const scraper of scrapers) {
    const result = await runScraperSafely(scraper.name, scraper.run);
    if (result.status) {
      successCount++;
      if (result.channel === 1) {
        messageBlocks1.push(...result.blocks);
        messageChannel1++;
      } else {
        messageBlocks2.push(...result.blocks);
        messageChannel2++;
      }
    } else {
      errorCount++;
    }
  }
  // Send all accumulated messages at once
  if (messageBlocks1.length > 0) {
    console.log(
      `📨 Sending accumulated message to channel 1 with ${messageBlocks1.length} blocks from ${messageChannel1} scrapers.`
    );
    try {
      await buildMessage(1, messageBlocks1);
    } catch (error) {
      console.error("💥 Failed to send message to channel 1:", error);
    }
  } else {
    console.log("📭 No messages to send to channel 1.");
  }
  if (messageBlocks2.length > 0) {
    console.log(
      `📨 Sending accumulated message to channel 2 with ${messageBlocks2.length} blocks from ${messageChannel2} scrapers.`
    );
    try {
      await buildMessage(2, messageBlocks2);
    } catch (error) {
      console.error("💥 Failed to send message to channel 2:", error);
    }
  } else {
    console.log("📭 No messages to send to channel 2.");
  }

  // console.log("Disabling channel 2 message sending for now.");

  console.log("─".repeat(50));
  console.timeEnd("Total Scraping Time");
  console.log(`📈 Scraping Summary:`);
  console.log(`  ✅ Successful: ${successCount}`);
  console.log(`  ❌ Failed: ${errorCount}`);
  console.log(
    `  📊 Success Rate: ${((successCount / scrapers.length) * 100).toFixed(1)}%`
  );
  console.log(`🏁 All job scrapers completed at: ${new Date().toISOString()}`);
}

// Global error handlers
process.on("uncaughtException", (error) => {
  console.error("💥 Uncaught Exception:", error);
  process.exit(1);
});

process.on("unhandledRejection", (reason, promise) => {
  console.error("💥 Unhandled Rejection at:", promise, "reason:", reason);
  process.exit(1);
});

main().catch((error) => {
  console.error("💥 Main function failed:", error);
  process.exit(1);
});

// test_message().catch((error) => {
//   console.error("💥 Test message function failed:", error);
//   process.exit(1);
// });
